#!/usr/bin/env python
# https://github.com/shift-crops/sc_pwn/blob/master/sc_pwn.py
from sc_pwn import *

env = Environment('local', 'remote')
env.set_item('mode',    local = 'SOCKET', remote = 'SOCKET')
env.set_item('target',  local   = {'host':'192.168.75.139','port':8080}, \
                        remote  = {'host':'beatmeonthedl_498e7cad3320af23962c78c7ebe47e16.quals.shallweplayaga.me','port':6969})
env.select()

binf = ELF('beatmeonthedl')
addr_plt_puts       = binf.plt('puts')
addr_got_main       = binf.got('__libc_start_main')
addr_bss            = binf.section('.bss')
addr_main           = binf.function('main')

#==========
def attack(cmn):
    beat = Beat(cmn)
    beat.login('mcfly', 'awesnap')

class Beat:
    def __init__(self, cmn):
        self.read_until = cmn.read_until
        self.read_all   = cmn.read_all
        self.sendln     = cmn.sendln
        self.send       = cmn.send

    def login(self, user, password):
        cmn.read_until('Enter username: ')
        cmn.sendln(user)
        cmn.read_until('Enter Pass: ')
        cmn.sendln(password)

    def request(self, text):
        cmn.read_until('| ')
        cmn.sendln('1')
        cmn.read_until('Request text > ')
        cmn.send(text)  

    def delete(self, no):
        cmn.read_until('| ')
        cmn.sendln('3')
        cmn.read_until('choice: ')
        cmn.send(str(no))     

    def change(self, no, text):
        cmn.read_until('| ')
        cmn.sendln('4')
        cmn.read_until('choice: ')
        cmn.send(str(no))   
        cmn.read_until('data: ')
        cmn.send(text)

#==========

if __name__=='__main__':
    cmn = Communicate(env.target, env.mode)
    attack(cmn)

    #sh = Shell(cmn)
    #sh.select()
    #del(sh)
    Interact(cmn).worker(False)
    
    del(cmn)
    
#==========
