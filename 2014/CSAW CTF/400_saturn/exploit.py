#!/usr/bin/env python
import socket
import struct
 
TCP_IP = '54.85.89.65'
TCP_PORT = 8888
BUFFER_SIZE = 512
 
challenges = []
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
 
# Header
s.recv(BUFFER_SIZE)
 
# Get challenge 0
s.send("\xA8")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 1
s.send("\xA9")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 2
s.send("\xAA")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 3
s.send("\xAB")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 4
s.send("\xAC")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 5
s.send("\xAD")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 6
s.send("\xAE")
chall = s.recv(4)
challenges.append(chall)
 
# Get challenge 7
s.send("\xAF")
chall = s.recv(4)
challenges.append(chall)
 
# Send challenge response
chall_res = "\xE0" + challenges[0] + "\xE1" + challenges[1]  + "\xE2" + challenges[2]  + "\xE3" + challenges[3]  + "\xE4" + challenges[4]  + "\xE5" + challenges[5]  + "\xE6" + challenges[6]  + "\xE7" + challenges[7]
s.send(chall_res)
 
# Get flag
s.send("\x80")
 
# Display flag
data = s.recv(BUFFER_SIZE)
print data
